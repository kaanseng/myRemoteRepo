<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Basic HTML Examples</title>

<script language="javascript">
    function loadURL(URL) {
    	//向URL發出request
    	fetch(URL,{
    		method: 'POST', // or 'GET'
    	})
    	.then(function(res){ //fetch的callback function，傳回值是promise物件: res
    		//將res的內容轉為文字，傳給下一個Callback function
    		return res.text();
    	})
    	.then(function(data){ //下一個callback function，參數data是上一個callback傳進來的文字
    		
    		//找到要顯示內容的div
    		let div = document.getElementById('let go');
    		//將傳進來的文字放進div中
    		div.innerHTML=data;
    	})
    }

    function loadEditForm(id) {
        // let url = "a3.editUI.py?id="+id;
        let url = "3.editUI.php?id="+id;
        loadURL(url);
    }
    
    function deleteForm(id){
        let url = "4.deleteUI.php?id="+id;
        loadURL(url);
    }

    function postForm() {
        //取得表單物件
        let form = document.getElementById('myForm');
        //用表單內容產生一個 formdata物件
        let mydat = new FormData(form);
        console.log(mydat)
    
        let url="1.insert.php";
        fetch(url,{
            method: 'POST',
            body: mydat // 將表單物件放入fetch的body屬性
        })
        .then(function(res){return res.text(); }) //取得傳回值，轉為文字
        .then(function(data){ 
            //找到要顯示內容的div
            let div = document.getElementById('let go');
            //將傳進來的文字放進div中
            div.innerHTML=data;
        })
    
    }

    function loadlist() {
        //取得表單物件
        let form = document.getElementById('myForm');
        //用表單內容產生一個 formdata物件
        let mydat = new FormData(form);
        console.log(mydat)
    
        let url="2.list.php";
        fetch(url,{
            method: 'POST',
            body: mydat // 將表單物件放入fetch的body屬性
        })
        .then(function(res){return res.text(); }) //取得傳回值，轉為文字
        .then(function(data){ 
            //找到要顯示內容的div
            let div = document.getElementById('let go');
            //將傳進來的文字放進div中
            div.innerHTML=data;
        })
    }

    function loadaddform() {
        location.href = "0.輸入表單.html";
    }


</script>

</head>
<body>
<form id="myForm" method="post" action="3.update.php">
<!-- <form method="post" action="1.insert.php"> 1.insert.php -->
<!-- <p><button onclick="postForm()">Load</button></p> -->
<button type="button" onclick="loadlist()">Load List</button>
<button type="button" onclick="loadaddform()">Load Add Form</button>

<div id="let go">
工作名稱: <input name="name" type="text"  /> <br>

緊急程度: <select name="urgent">
<option value="普通" selected>普通</option>
<option value="急">急</option>
<option value="急死了">急死了</option>
</select> <br>

工作說明: <textarea name='content'></textarea><br>

<!-- <input type="submit" name="Submit" value="送出" /> -->

<input type='button' onClick="postForm()" value="送出">
</div>

<div id="main"><h1>This is the main page.</h1></div>
</form>

</body></html>